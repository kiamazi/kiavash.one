<!DOCTYPE html>
<html lang="Farsi">
<head>
  <title> | راهنمای بازی در گنو/لینوکس، اتصال دسته بازی Xbox One S</title>

  <meta charset="utf-8">
  <meta name="description" content="در ستایش تجربه کردن و یادگرفتن همیشگی / open experience">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:type" content="website">
  <meta property="og:title" content="راهنمای بازی در گنو/لینوکس، اتصال دسته بازی Xbox One S">
  <meta property="og:url" content="http://kiavash.one/">
  <meta property="og:site_name" content="تجربه باز">
  <meta property="og:description" content="&lt;p&gt;توی چند سال گذشته وضعیت بازی‌ها در سیستم‌عامل‌های آزاد نسبت به گذشته خیلی فرق کرده و با وجود Steam عناوین زیادی از بازی‌ها، برای  نصب مستقیم در گنو/لینوکس منتشر میشن و با کمک wine هم میشه اکثر بازی‌های معروفی که برای ویندوز منتشر شدن رو، روی گنو/لینوکس‌ها هم با کیفیت خیلی خوب نصب و اجرا کرد. اما همچنان مشکلاتی وجود داره و هنوز همه چیز مثل ویندوز، وصل کن و استفاده کن نیست. یکی از این مشکلات هم استفاده وایرلس از کنترلرهای بازی یا همون دسته‌های بازی هست.

  توضیح: از نظر قیمت و راحتی استفاده و جای دکمه‌ها و خیلی دلایل شخصی دیگه، من چند سال پیش تصمیم گرفتم یک دسته بازی Xbox One S بخرم، ولی باید ای&lt;/p&gt;">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="راهنمای بازی در گنو/لینوکس، اتصال دسته بازی Xbox One S">
  <meta name="twitter:description" content="&lt;p&gt;توی چند سال گذشته وضعیت بازی‌ها در سیس...">

  <link rel="alternative" href="/atom.xml" title="تجربه باز" type="application/atom+xml">
  <link rel="short icon" href="/static/img/logo.png">
  <link rel="stylesheet" href="/static/theme/miramal/css/style.css" type="text/css">

</head>
<body>

<!-- Header -->
<header>
  <section class="container">
    <nav>
      <h1 class="name-title"><a href="/">تجربه باز</a></h1>
      <ul>
        
          <li><a href="/atom.xml">atom</a></li>
          <li><a href="/">فهرست</a></li>
          <li><a href="/about/">درباره</a></li>
          <li><a href="http://github.com/kiamazi" target="_blank">گیت‌هاب</a></li>
          <li><a href="http://twitter.com/kiavash" target="_blank">توییتر</a></li>
        
      </ul>
    </nav>
    <div class="logo">
       
         <h1>راهنمای بازی در گنو/لینوکس، اتصال دسته بازی Xbox One S</h1>
         <h4>سری راهنمای بازی در گنو/لینوکس: اتصال دسته‌های بازی از طریق اتصال بلوتوث</h4>
        
    </div>
  </section>
</header>
<!-- /Header -->

<section id="content" class="container">

  <article id="gnu-linux-gaming-tip-how-to-pair-xbox-one-S-controller-via-bluetooth" class="article article-type-post" itemscope itemprop="blogPost">
    <!--<h2 class="title" itemprop="name">راهنمای بازی در گنو/لینوکس، اتصال دسته بازی Xbox One S</h2>-->
 
    
      <h4 class="time">
    <time datetime="2020-06-03 17:10:20" itemprop="datePublished">چهارشنبه، ۱۴ خرداد ۱۳۹۹</time>
  </h4>
    

    <section class="content">
    <a name="more"></a>
<p>توی چند سال گذشته وضعیت بازی‌ها در سیستم‌عامل‌های آزاد نسبت به گذشته خیلی فرق کرده و با وجود Steam عناوین زیادی از بازی‌ها، برای  نصب مستقیم در گنو/لینوکس منتشر میشن و با کمک wine هم میشه اکثر بازی‌های معروفی که برای ویندوز منتشر شدن رو، روی گنو/لینوکس‌ها هم با کیفیت خیلی خوب نصب و اجرا کرد. اما همچنان مشکلاتی وجود داره و هنوز همه چیز مثل ویندوز، وصل کن و استفاده کن نیست. یکی از این مشکلات هم استفاده وایرلس از کنترلرهای بازی یا همون دسته‌های بازی هست.</p>

<blockquote>
  <p>توضیح: از نظر قیمت و راحتی استفاده و جای دکمه‌ها و خیلی دلایل شخصی دیگه، من چند سال پیش تصمیم گرفتم یک دسته بازی Xbox One S بخرم، ولی باید این نکته رو اضافه کنم که اگه هدف اصلیتون بازی کردن روی استیم هست، دسته‌های Nintendo Switch Pro، جایگزین خیلی خوبی هستند که به شکل رسمی توسط استیم هم پشتیبانی میشن و در ضمن قابل شارژ هم هستند و لازم نیست نگرانی عوض کردن باطری رو هم داشته باشید، اما این کنترلرها هم مشکل اتصال بلوتوث روی اوبونتو رو دارن.</p>
</blockquote>

<p>بارها سعی کردم دسته بازی Xbox One S رو به اوبونتو وصل کنم، متصل کردن دسته با کمک کابل و از طریق پورت usb خیلی کار راحتی بود، کافی بود دسته رو با کابل به کامپیوتر وصل کنم و بدون هیچ مشکلی، اوبونتو دسته بازی رو تشخیص میداد و خیلی راحت از کنترلر استفاده میکردم، اما مشکل از جایی شروع میشد که میخواستم بدون سیم و از طریق بلوتوث دسته رو به کامپیوتر وصل کنم، با وجودی که توی تنظیمات بلوتوث نشون میداد که دسته رو شناخته و توی منو هم کلید connect فعال بود، اما بعد از سعی برای کانکت کردنش، در عرض یکی دو ثانیه، اتصال قطع میشد!</p>

<p><img src="/images/2020-06-03-xbox-one-s-01.gif" alt="connect, disconnect" id="connect__disconnect"></p>

<p>خوب از اونجایی که اوبونتو دسته رو بدون مشکل پیدا میکنه و حتی برای چند ثانیه کوتاه هم بهش کانکت میشه، کاملا مشخصه که یه چیزی این وسط هست که داره اتصال رو بلاک میکنه و باعث قطع شدنش میشه. اعتراف میکنم بعد از بارها جستجو و تلاش برای پیدا کردن راه‌حل این مشکل، از اتصال بلوتوث دسته برای چند سال ناامید شدم و کلا بی‌خیال اموضوع شده بودم تا اینکه بالاخره، خیلی اتفاقی فهمیدم این مردم آزار چیزی نیست به جز یک پروتوکل بلوتوث توی لینوکس که به اسم <strong>Enhanced Re-Transmission Mode</strong> یا <strong>حالت انتقال مجدد بهبود یافته</strong> شناخته میشه. توی ادامه متن به این پروتکل به شکل خلاصه میگم  <code>ertm</code>.</p>

<hr>

<h2 id="راه_حل‌ها">راه حل‌ها</h2>

<h3 id="راه_حل_اول">راه حل اول</h3>

<blockquote>
  <p>قبل از توضیح دادن، باید بگم که خودم از این راه حل استفاده نمیکنم و راه حل دوم رو پیشنهاد میکنم.</p>
</blockquote>

<p>ترمینال رو باز می‌کنیم و این دستور رو تایپ میکنیم:</p>

<pre><code>sudo sh -c 'echo 1 &gt; /sys/module/bluetooth/parameters/disable_ertm'
</code></pre>

<p>عملا همه چیز تمام شد، دسته بازی رو بدون هیچ مشکلی به کامپیوتر وصل کنید. این دستور، پروتکل مذکور رو غیرفعال میکنه، اما باید یادآوری کنم که اثر موقت داره، یعنی بعد از بوت کردن مجدد، همه چیز به حالت قبل برگشته و مجددا ertm فعال میشه. اگر بخوایم این دستور رو همیشگی کنیم، نیاز داریم یک فایل تنظیمات رو ویرایش(یا ایجاد) کنیم.</p>

<pre><code>sudo nano /etc/modprobe.d/bluetooth.conf
</code></pre>

<p>با این دستور، ویرایشگر nano فایل تنظیمات رو برای ویرایش باز میکنه یا در صورتی که فایل از قبل وجود نداشته باشه اون رو ایجاد میکنه. حالا دستور زیر رو توی فایل تنظمیات تایپ کنید:</p>

<pre><code>options bluetooth disable_ertm=1
</code></pre>

<p>با کلیدهای ترکیبی <code>ctrl+O</code> و بعدش زدن کلید اینتر برای تایید اسم فایل، فایل رو ذخیره میکنیم و با کلیدهای ترکیبی <code>Ctrl+X</code> از ویرایشگر خارج میشیم.</p>

<hr>

<p>اگر استفاده کردن از nano رو دوست ندارید میتونید از هر ویرایشگر دیگه‌ای که نصب دارید، استفاده کنید، برای مثال دستور زیر فایل تنظیمات رو با ویرایشگر پیش‌فرض Gnome یعنی برنامه gedit باز میکنه که یه ویرایشگر گرافیکیه و کار باهاش راحت‌تره.</p>

<pre><code>sudo gedit /etc/modprobe.d/bluetooth.conf
</code></pre>

<p>توی این حالت بعد از ویرایش کردن فایل، خیلی راحت با زدن کلید <code>save</code> فایل رو ذخیره کنید و برنامه رو ببندید.</p>

<hr>

<p>کامپیوتر رو یک بار ری‌استارت کنید و تمام، با خیال راحت از این به بعد کنترلرهای بازیتون رو بدون مشکل از طریق اتصال بلوتوث وصل کنید و بازی کنید.</p>

<p>توضیح این دستورات و تنظیمات هم به شکل ساده میشه اینکه، داریم به سیستم عامل میگیم موقع بوت شدن ertm رو غیر فعال کنه.</p>

<p><strong>نکته مهم</strong>: این راه حل در صورت فعال بودن ممکنه باعث ایجاد مشکل در سایر دستگاه های بلوتوث مانند هدفون بشه. اگر بعد از اجرای این راه حل در اتصال بلوتوث سایر دستگاه‌هاتون مشکلی داشتید، کافیه فایل بالا رو دوباره برای ویراش باز کنید و مقدار 1 رو به 0 تغییر بدید.</p>

<p><img src="/images/2020-06-03-xbox-one-s-02.png" alt="connected" id="connected"></p>

<hr>

<h3 id="راه_حل_دوم">راه حل دوم</h3>

<p>یه راه حل دیگه که برای حل کردن این مشکل داریم و من خودم از این راه استفاده کردم و به نظرم راه حل بهتری هست، استفاده از <code>sysfs</code> هست. به شکل خلاصه بزارید اول بگم sysfs چی هست.</p>

<blockquote>
  <p>‫sysfs یک فایل سیستم مجازیه که در هسته‌های لینوکس بعد از نسخه 2.5 اصافه شده و درخت(tree) دستگاه‌های متصل به سیستم رو در اختیار کاربر قرار میده... علاوه بر این، این بسته یک پرونده پیکربندی(فایل تنظیمات) رو در آدرس <code>/etc/sysfs.conf</code> ایجاد میکنه که به کاربر امکان میده به راحتی تنظیمات sysfs را در بوت سیستم (از طریق یک اسکریپت init) تنظیم کنه. توضیحات بیشتر رو میتونید توی <a href="http://linux-diag.sourceforge.net/Sysfsutils.html">صفحه پروژه</a> بخونید</p>
</blockquote>

<p>خوب الان که فهمیدیم sysfs چی هست و چه کار میکنه، بریم برای نصبش.</p>

<pre><code>sudo apt install sysfsutils
</code></pre>

<p>و بعداز نصب، فایل تنظیماتش رو ویرایش میکنیم، این فایل توی آدرس <code>/etc/sysfs.conf</code> قرار داره، پس برای ویرایش کردنش دستور زیر رو تایپ میکنیم:</p>

<pre><code>sudo nano /etc/sysfs.conf
</code></pre>

<p>آخر فایل یک خط جدید ایجاد میکنیم و این تنظیمات رو توی اون خط جدید تایپ میکنیم:</p>

<pre><code>/module/bluetooth/parameters/disable_ertm=1
</code></pre>

<p>با کلیدهای ترکیبی <code>ctrl+O</code> و بعدش زدن کلید اینتر برای تایید اسم فایل، فایل رو ذخیره میکنیم و با کلیدهای ترکیبی <code>Ctrl+X</code> از ویرایشگر خارج میشیم.</p>

<hr>

<p>یک بار دیگه باید یادآوری کنم که اگر استفاده کردن از nano رو دوست ندارید میتونید از هر ویرایشگر دیگه‌ای که نصب دارید، استفاده کنید، برای مثال دستور زیر فایل تنظیمات رو با ویرایشگر پیش‌فرض Gnome یعنی برنامه gedit باز میکنه:</p>

<pre><code>sudo gedit /etc/sysfs.conf
</code></pre>

<p>توی این حالت بعد از ویرایش کردن فایل، خیلی راحت با زدن کلید <code>save</code> فایل رو ذخیره کنید و برنامه رو ببندید.</p>

<hr>

<p>همونطوری که توی توضیحات بالا نوشته بودم، sysfs از init استفاده میکنه، پس به جای بوت کردن مجدد سیستم عامل، فقط اسکریپت مورد نظر رو ری‌استارت میکنیم، دستور زیر رو توی ترمینال اجرا کنید:</p>

<pre><code>sudo systemctl restart sysfsutils.service 
</code></pre>

<p>تمام شد، از این به بعد خیلی راحت و بدون دردسر کنترلرهای Xbox یا Nintendo رو از طریق اتصال بلوتوث به کامپیوتر وصل کنید.</p>

<p><strong>نکته مهم</strong>: این راه حل هم در صورت فعال بودن ممکنه باعث ایجاد مشکل در سایر دستگاه های بلوتوث مانند هدفون بشه. به هر حال این راه حل هم داره ertm رو غیرفعال میکنه، اما اگه از sysfs به عنوان راه حل دارید استفاده میکنید، فقط کافیه که با تایپ کردن دستور زیر توی ترمینال، اجراش رو متوقف کنید:</p>

<pre><code>sudo systemctl stop sysfsutils.service
</code></pre>

<p>و هر وقت که نیاز داشتید، خیلی راحت با دستور زیر، مجددا راه اندازیش کنید</p>

<pre><code>sudo systemctl start sysfsutils.service 
</code></pre>

<p><img src="/images/2020-06-03-xbox-one-s-03.png" alt="connected" id="connected"></p>
  </section>
  
  <section class="meta">
    <span>        دسته بندی:          <a href="/categories/گنو-لینوکس/">گنو/لینوکس</a>        برچسب‌ها:          <a href="/tags/گنو-لینوکس/">گنو/لینوکس</a>،&nbsp;          <a href="/tags/ubuntu/">اوبونتو</a>،&nbsp;          <a href="/tags/بازی/">بازی</a>    </span>
  </section>


    <div class="contribute">
در صورتیکه بعد از خواندن این یادداشت بخواهید به هر شکلی در تکمیلش مشارکت کنید، مثلا آن را اصلاح کنید یا مطلبی به آن اضافه کنید، منبع این یادداشت روی گیت‌هاب در این آدرس در دسترس است: <br>
<a href="https://github.com/kiamazi/kiavash.one/blob/master/content/blog/2020-06-03-gnu-linux-gaming-tip-how-to-pair-xbox-one-S-controller-via-bluetooth.md">https://github.com/kiamazi/kiavash.one/blob/master/content/blog/2020-06-03-gnu-linux-gaming-tip-how-to-pair-xbox-one-S-controller-via-bluetooth.md</a><br>
 میتوانید آن‌را ویرایش کنید. البته باید یادآوری کنم که هر ویرایشی قبل از اتشار نیاز به تایید دارد.
    </div>

<hr>
<script async src="https://comments.app/js/widget.js?3" data-comments-app-website="X6-bEnpe" data-limit="5" data-dislikes="1" data-outlined="1" data-colorful="1"></script>
<hr>
    
      این وبلاگ از disqus برای سیستم نظردهی استفاده می‌کند، اگر فرم نظردادن را نمی‌بینید احتمالا کسی به جای شما تشخیص داده که این سرویس مناسبتان نیست و آن را از دسترس شما خارج کرده، برای نظردادن در این شرایط از ابزار رفع فیلتر استفاده کنید
<section class="comments">
  <div id="disqus_thread">
    <script>
      var disqus_shortname = 'kiavash';
      (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
    
  </article>

</section>

<!-- Paging -->
<section class="pagination">
  <nav class="container">
    
      <a></a>
    
      <a class="extend next" rel="next" href="/2020/05/16/remove-old-snap-versions-to-free-up-disk-space/">
        <i>-></i>
        <span>حذف نسخه‌های قدیمی برنامه‌های snap</span>
      </a>
  </nav>
</section>
<!-- /Paging -->

<!-- /Content -->
<!-- Footer -->
<footer>
    <!--<section class="copyright">

    </section>
    <section class="container">
      <div class="delimiter">
        <a href="/" class="logo">
          <img src="/static/img/logo.png">
        </a>
      </div>-->
      <p>
        
          تمام حقوق محفوظ است<br>
          مطالب تحت لیسانس <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" rel="license" target="_blank">کریتیو کامنز</a> منتشر می‌شوند
          <p>قدرت گرفته توسط <a href="https://miraxy.github.io/fa/">میرا</a></p>
        
      </p>
    </section>
</footer>
<!-- /Footer -->

<!-- Scripts -->
<script src="/static/theme/miramal/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>